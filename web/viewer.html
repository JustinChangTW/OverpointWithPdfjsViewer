<!DOCTYPE html>
<!--
Copyright 2012 Mozilla Foundation

Licensed under the Apache License, Version 2.0 (the "License");=＋
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Adobe CMap resources are covered by their own copyright but the same license:

    Copyright 1990-2015 Adobe Systems Incorporated.

See https://github.com/adobe-type-tools/cmap-resources
-->
<html dir="ltr" mozdisallowselectionprint>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="google" content="notranslate">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>PDF.js viewer</title>


    <link rel="stylesheet" href="viewer.css">


    <!-- This snippet is used in production (included from viewer.html) -->
    <link rel="resource" type="application/l10n" href="locale/locale.properties">
    <!-- <script src="../build/pdf.js"></script> -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf.worker.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf_viewer.js'></script>
    <script src="viewer.js"></script>

    <script src="https://unpkg.com/pdf-lib@1.4.0"></script>
    <script src="https://unpkg.com/@pdf-lib/fontkit@0.0.4"></script>
    <script src="https://unpkg.com/downloadjs@1.4.7"></script>
    <style>
        .pdfContainer {
            box-sizing: border-box;
            border: 1px green solid;
            height: 100%!important;
        }
        
        .editContainer {
            box-sizing: border-box;
            border: 1px green solid;
            height: 40%;
        }
        
        .editText {
            color: red;
            font-size: 12px;
        }
        
        #viewerContainer {
            overflow: unset;
        }
        
        #mouseCursor {
            width: 200px;
            color: blue;
            position: fixed;
        }
        
        .tempDiv {
            border: 2px dashed red;
            position: fixed;
        }
        
        .edit {
            display: none;
            position: fixed;
            width: 100%;
            height: 100%;
            background: rgba(125, 123, 123, 0.387);
            top: 0;
        }
        
        .editContent {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            width: 400px;
            height: 580px;
            border: 9px solid rgba(0, 13, 255, 0.421);
            border-radius: 8px 8px 8px 8px;
            padding: 30px;
        }
        
        .editClose {
            position: relative;
            display: inline-block;
            background: #fff;
            border: 6px solid rgba(0, 13, 255, 0.421);
            width: 50px;
            height: 50px;
            border-radius: 100%;
            left: 97%;
            top: -9%;
            vertical-align: middle;
            text-align: center;
        }
        
        .editClose:hover {
            background: rgba(170, 170, 170, 0.816);
        }
        
        .editClose::before {
            content: "";
            position: absolute;
            width: 52px;
            top: 40%;
            left: -1px;
            /* padding-left: 100px; */
            border-bottom: 10px solid rgba(0, 13, 255, 0.421);
            transform: rotate(-45deg);
            /* border: 1px solid red; */
        }
        
        .editClose::after {
            content: "";
            position: absolute;
            width: 52px;
            top: 40%;
            left: 1px;
            border-bottom: 10px solid rgba(0, 13, 255, 0.421);
            transform: rotate(45deg);
        }
        
        .editContent input,
        .editContent select {
            color: #6c757d;
            opacity: 1;
            width: 100%;
            padding: 0.5rem 0.1rem;
        }
        
        .editContent input:focus {
            border-color: #8bbafe;
            outline: 0;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }
        
        .editContent label {
            margin-bottom: 0.5rem;
            padding-top: calc(0.375rem + 1px);
            padding-bottom: calc(0.375rem + 1px);
            margin-bottom: 0;
            font-size: inherit;
            line-height: 1.5;
        }
        
        .editContent select {
            display: block;
            width: 100%;
            height: calc(1.5em + 0.75rem + 3px);
            padding: 0.375rem 1.75rem 0.375rem 0.75rem;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #495057;
            vertical-align: middle;
            background-color: #fff;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 16px 12px;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        
        .CusToolBar {
            width: 100px;
            border: 1px solid #fff !important;
        }
        
        .pointDiv {
            font-size: 8px;
            position: absolute;
            border: 1px solid #aaa;
        }
        
        .pointDot {
            content: "";
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: rgb(255, 255, 0);
            border: 1px solid #aaa;
            right: -3px;
            bottom: -3px;
            pointer-events: auto;
        }
    </style>

</head>

<body tabindex="1" class="loadingInProgress">
    <div id="outerContainer" class="pdfContainer">

        <div id="sidebarContainer">
            <div id="toolbarSidebar">
                <div class="splitToolbarButton toggled">
                    <button id="viewThumbnail" class="toolbarButton toggled" title="Show Thumbnails" tabindex="2" data-l10n-id="thumbs">
                      <span data-l10n-id="thumbs_label">Thumbnails</span>
                    </button>
                    <button id="viewOutline" class="toolbarButton" title="Show Document Outline (double-click to expand/collapse all items)" tabindex="3" data-l10n-id="document_outline">
                      <span data-l10n-id="document_outline_label">Document Outline</span>
                    </button>
                    <button id="viewAttachments" class="toolbarButton" title="Show Attachments" tabindex="4" data-l10n-id="attachments">
                      <span data-l10n-id="attachments_label">Attachments</span>
                    </button>
                </div>
            </div>
            <div id="sidebarContent">
                <div id="thumbnailView">
                </div>
                <div id="outlineView" class="hidden">
                </div>
                <div id="attachmentsView" class="hidden">
                </div>
            </div>
            <div id="sidebarResizer" class="hidden"></div>
        </div>
        <!-- sidebarContainer -->

        <div id="mainContainer">
            <div class="findbar hidden doorHanger" id="findbar">
                <div id="findbarInputContainer">
                    <input id="findInput" class="toolbarField" title="Find" placeholder="Find in document…" tabindex="91" data-l10n-id="find_input">
                    <div class="splitToolbarButton">
                        <button id="findPrevious" class="toolbarButton findPrevious" title="Find the previous occurrence of the phrase" tabindex="92" data-l10n-id="find_previous">
                        <span data-l10n-id="find_previous_label">Previous</span>
                    </button>
                        <div class="splitToolbarButtonSeparator"></div>
                        <button id="findNext" class="toolbarButton findNext" title="Find the next occurrence of the phrase" tabindex="93" data-l10n-id="find_next">
                        <span data-l10n-id="find_next_label">Next</span>
                    </button>
                    </div>
                </div>

                <div id="findbarOptionsOneContainer">
                    <input type="checkbox" id="findHighlightAll" class="toolbarField" tabindex="94">
                    <label for="findHighlightAll" class="toolbarLabel" data-l10n-id="find_highlight">Highlight all</label>
                    <input type="checkbox" id="findMatchCase" class="toolbarField" tabindex="95">
                    <label for="findMatchCase" class="toolbarLabel" data-l10n-id="find_match_case_label">Match case</label>
                </div>
                <div id="findbarOptionsTwoContainer">
                    <input type="checkbox" id="findEntireWord" class="toolbarField" tabindex="96">
                    <label for="findEntireWord" class="toolbarLabel" data-l10n-id="find_entire_word_label">Whole words</label>
                    <span id="findResultsCount" class="toolbarLabel hidden"></span>
                </div>

                <div id="findbarMessageContainer">
                    <span id="findMsg" class="toolbarLabel"></span>
                </div>
            </div>
            <!-- findbar -->

            <div id="secondaryToolbar" class="secondaryToolbar hidden doorHangerRight">
                <div id="secondaryToolbarButtonContainer">
                    <button id="secondaryPresentationMode" class="secondaryToolbarButton presentationMode visibleLargeView" title="Switch to Presentation Mode" tabindex="51" data-l10n-id="presentation_mode">
                      <span data-l10n-id="presentation_mode_label">Presentation Mode</span>
                    </button>

                    <button id="secondaryOpenFile" class="secondaryToolbarButton openFile visibleLargeView" title="Open File" tabindex="52" data-l10n-id="open_file">
                      <span data-l10n-id="open_file_label">Open</span>
                    </button>

                    <button id="secondaryPrint" class="secondaryToolbarButton print visibleMediumView" title="Print" tabindex="53" data-l10n-id="print">
                      <span data-l10n-id="print_label">Print</span>
                    </button>

                    <button id="secondaryDownload" class="secondaryToolbarButton download visibleMediumView" title="Download" tabindex="54" data-l10n-id="download">
                      <span data-l10n-id="download_label">Download</span>
                    </button>

                    <a href="#" id="secondaryViewBookmark" class="secondaryToolbarButton     bookmark visibleSmallView" title="Current view (copy or open in new window)" tabindex="55" data-l10n-id="bookmark">
                        <span data-l10n-id="bookmark_label">Current View</span>
                    </a>

                    <div class="horizontalToolbarSeparator visibleLargeView"></div>

                    <button id="firstPage" class="secondaryToolbarButton firstPage" title="Go to First Page" tabindex="56" data-l10n-id="first_page">
                      <span data-l10n-id="first_page_label">Go to First Page</span>
                      </button>
                    <button id="lastPage" class="secondaryToolbarButton lastPage" title="Go to Last Page" tabindex="57" data-l10n-id="last_page">
                      <span data-l10n-id="last_page_label">Go to Last Page</span>
                    </button>

                    <div class="horizontalToolbarSeparator"></div>

                    <button id="pageRotateCw" class="secondaryToolbarButton rotateCw" title="Rotate Clockwise" tabindex="58" data-l10n-id="page_rotate_cw">
                      <span data-l10n-id="page_rotate_cw_label">Rotate Clockwise</span>
                    </button>
                    <button id="pageRotateCcw" class="secondaryToolbarButton rotateCcw" title="Rotate Counterclockwise" tabindex="59" data-l10n-id="page_rotate_ccw">
                      <span data-l10n-id="page_rotate_ccw_label">Rotate Counterclockwise</span>
                    </button>

                    <div class="horizontalToolbarSeparator"></div>

                    <button id="cursorSelectTool" class="secondaryToolbarButton selectTool toggled" title="Enable Text Selection Tool" tabindex="60" data-l10n-id="cursor_text_select_tool">
                      <span data-l10n-id="cursor_text_select_tool_label">Text Selection Tool</span>
                    </button>
                    <button id="cursorHandTool" class="secondaryToolbarButton handTool" title="Enable Hand Tool" tabindex="61" data-l10n-id="cursor_hand_tool">
                      <span data-l10n-id="cursor_hand_tool_label">Hand Tool</span>
                    </button>

                    <div class="horizontalToolbarSeparator"></div>

                    <button id="scrollVertical" class="secondaryToolbarButton scrollModeButtons scrollVertical toggled" title="Use Vertical Scrolling" tabindex="62" data-l10n-id="scroll_vertical">
                      <span data-l10n-id="scroll_vertical_label">Vertical Scrolling</span>
                    </button>
                    <button id="scrollHorizontal" class="secondaryToolbarButton scrollModeButtons scrollHorizontal" title="Use Horizontal Scrolling" tabindex="63" data-l10n-id="scroll_horizontal">
                        <span data-l10n-id="scroll_horizontal_label">Horizontal Scrolling</span>
                    </button>
                    <button id="scrollWrapped" class="secondaryToolbarButton scrollModeButtons scrollWrapped" title="Use Wrapped Scrolling" tabindex="64" data-l10n-id="scroll_wrapped">
                        <span data-l10n-id="scroll_wrapped_label">Wrapped Scrolling</span>
                    </button>

                    <div class="horizontalToolbarSeparator scrollModeButtons"></div>

                    <button id="spreadNone" class="secondaryToolbarButton spreadModeButtons spreadNone toggled" title="Do not join page spreads" tabindex="65" data-l10n-id="spread_none">
                        <span data-l10n-id="spread_none_label">No Spreads</span>
                    </button>
                    <button id="spreadOdd" class="secondaryToolbarButton spreadModeButtons spreadOdd" title="Join page spreads starting with odd-numbered pages" tabindex="66" data-l10n-id="spread_odd">
                        <span data-l10n-id="spread_odd_label">Odd Spreads</span>
                    </button>
                    <button id="spreadEven" class="secondaryToolbarButton spreadModeButtons spreadEven" title="Join page spreads starting with even-numbered pages" tabindex="67" data-l10n-id="spread_even">
                        <span data-l10n-id="spread_even_label">Even Spreads</span>
                    </button>
                    <div class="horizontalToolbarSeparator spreadModeButtons"></div>
                    <button id="documentProperties" class="secondaryToolbarButton documentProperties" title="Document Properties…" tabindex="68" data-l10n-id="document_properties">
                        <span data-l10n-id="document_properties_label">Document Properties…</span>
                    </button>
                </div>
            </div>
            <!-- secondaryToolbar -->

            <div class="toolbar">
                <div id="toolbarContainer">
                    <div id="toolbarViewer">
                        <div id="toolbarViewerLeft">
                            <button id="sidebarToggle" class="toolbarButton" title="Toggle Sidebar" tabindex="11" data-l10n-id="toggle_sidebar">
                                <span data-l10n-id="toggle_sidebar_label">Toggle Sidebar</span>
                            </button>
                            <div class="toolbarButtonSpacer"></div>
                            <button id="viewFind" class="toolbarButton" title="Find in Document" tabindex="12" data-l10n-id="findbar">
                                <span data-l10n-id="findbar_label">Find</span>
                            </button>
                            <div class="splitToolbarButton hiddenSmallView">
                                <button class="toolbarButton pageUp" title="Previous Page" id="previous" tabindex="13" data-l10n-id="previous">
                                <span data-l10n-id="previous_label">Previous</span>
                            </button>
                                <div class="splitToolbarButtonSeparator"></div>
                                <button class="toolbarButton pageDown" title="Next Page" id="next" tabindex="14" data-l10n-id="next">
                                <span data-l10n-id="next_label">Next</span>
                            </button>
                            </div>
                            <input type="number" id="pageNumber" class="toolbarField pageNumber" title="Page" value="1" size="4" min="1" tabindex="15" data-l10n-id="page">
                            <span id="numPages" class="toolbarLabel"></span>
                        </div>
                        <div id="toolbarViewerRight">
                            <button id="presentationMode" class="toolbarButton presentationMode hiddenLargeView" title="Switch to Presentation Mode" tabindex="31" data-l10n-id="presentation_mode">
                                <span data-l10n-id="presentation_mode_label">Presentation Mode</span>
                            </button>

                            <button id="openFile" class="toolbarButton openFile hiddenLargeView" title="Open File" tabindex="32" data-l10n-id="open_file" disabled=none>
                                <span data-l10n-id="open_file_label">Open</span>
                            </button>

                            <button id="print" class="toolbarButton print hiddenMediumView" title="Print" tabindex="33" data-l10n-id="print" disabled=none>
                                <span data-l10n-id="print_label">Print</span>
                            </button>

                            <button id="download" class="toolbarButton download hiddenMediumView" title="Download" tabindex="34" data-l10n-id="download">
                                <span data-l10n-id="download_label">Download</span>
                            </button>
                            <a href="#" id="viewBookmark" class="toolbarButton bookmark hiddenSmallView" title="Current view (copy or open in new window)" tabindex="35" data-l10n-id="bookmark">
                                <span data-l10n-id="bookmark_label">Current View</span>
                            </a>

                            <div class="verticalToolbarSeparator hiddenSmallView"></div>

                            <button id="secondaryToolbarToggle" class="toolbarButton" title="Tools" tabindex="36" data-l10n-id="tools">
                                <span data-l10n-id="tools_label">Tools</span>
                            </button>
                        </div>
                        <div id="toolbarViewerMiddle">
                            <div class="splitToolbarButton" style="display: none;">
                                <button id="zoomOut" class="toolbarButton zoomOut" title="Zoom Out" tabindex="21" data-l10n-id="zoom_out">
                                    <span data-l10n-id="zoom_out_label">Zoom Out</span>
                                </button>
                                <div class="splitToolbarButtonSeparator"></div>
                                <button id="zoomIn" class="toolbarButton zoomIn" title="Zoom In" tabindex="22" data-l10n-id="zoom_in">
                                    <span data-l10n-id="zoom_in_label">Zoom In</span>
                                </button>
                            </div>
                            <span id="scaleSelectContainer" class="dropdownToolbarButton" style="display: none;">
                                <select id="scaleSelect" title="Zoom" tabindex="23" data-l10n-id="zoom">
                                    <option id="pageAutoOption" title="" value="auto" selected="selected" data-l10n-id="page_scale_auto">Automatic Zoom</option>
                                    <option id="pageActualOption" title="" value="page-actual" data-l10n-id="page_scale_actual">Actual Size</option>
                                    <option id="pageFitOption" title="" value="page-fit" data-l10n-id="page_scale_fit">Page Fit</option>
                                    <option id="pageWidthOption" title="" value="page-width" data-l10n-id="page_scale_width">Page Width</option>
                                    <option id="customScaleOption" title="" value="custom" disabled="disabled" hidden="true"></option>
                                    <option title="" value="0.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 50 }'>50%</option>
                                    <option title="" value="0.75" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 75 }'>75%</option>
                                    <option title="" value="1" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 100 }'>100%</option>
                                    <option title="" value="1.25" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 125 }'>125%</option>
                                    <option title="" value="1.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 150 }'>150%</option>
                                    <option title="" value="2" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 200 }'>200%</option>
                                    <option title="" value="3" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 300 }'>300%</option>
                                <option title="" value="4" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 400 }'>400%</option>
                                </select>
                            </span>

                            <div class="splitToolbarButton">
                                <button class="toolbarButton CusToolBar" id="showPoint">套印定位點資料</button>
                            </div>
                            <div class="splitToolbarButton">
                                <button class="toolbarButton CusToolBar" id="overprint">套印PDF</button>
                            </div>
                        </div>

                    </div>
                    <div id="loadingBar">
                        <div class="progress">
                            <div class="glimmer">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <menu type="context" id="viewerContextMenu">
                <menuitem id="contextFirstPage" label="First Page" data-l10n-id="first_page"></menuitem>
                <menuitem id="contextLastPage" label="Last Page" data-l10n-id="last_page"></menuitem>
                <menuitem id="contextPageRotateCw" label="Rotate Clockwise" data-l10n-id="page_rotate_cw"></menuitem>
                <menuitem id="contextPageRotateCcw" label="Rotate Counter-Clockwise" data-l10n-id="page_rotate_ccw"></menuitem>
            </menu>

            <div id="viewerContainer" tabindex="0">
                <div id="viewer" class="pdfViewer"></div>
            </div>

            <div id="errorWrapper" hidden='true'>
                <div id="errorMessageLeft">
                    <span id="errorMessage"></span>
                    <button id="errorShowMore" data-l10n-id="error_more_info">
                      More Information
                    </button>
                    <button id="errorShowLess" data-l10n-id="error_less_info" hidden='true'>
                      Less Information
                    </button>
                </div>
                <div id="errorMessageRight">
                    <button id="errorClose" data-l10n-id="error_close">
                    Close
                    </button>
                </div>
                <div class="clearBoth"></div>
                <textarea id="errorMoreInfo" hidden='true' readonly="readonly"></textarea>
            </div>
        </div>
        <!-- mainContainer -->

        <div id="overlayContainer" class="hidden">
            <div id="passwordOverlay" class="container hidden">
                <div class="dialog">
                    <div class="row">
                        <p id="passwordText" data-l10n-id="password_label">Enter the password to open this PDF file:</p>
                    </div>
                    <div class="row">
                        <input type="password" id="password" class="toolbarField">
                    </div>
                    <div class="buttonRow">
                        <button id="passwordCancel" class="overlayButton"><span data-l10n-id="password_cancel">Cancel</span></button>
                        <button id="passwordSubmit" class="overlayButton"><span data-l10n-id="password_ok">OK</span></button>
                    </div>
                </div>
            </div>
            <div id="documentPropertiesOverlay" class="container hidden">
                <div class="dialog">
                    <div class="row">
                        <span data-l10n-id="document_properties_file_name">File name:</span>
                        <p id="fileNameField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_file_size">File size:</span>
                        <p id="fileSizeField">-</p>
                    </div>
                    <div class="separator"></div>
                    <div class="row">
                        <span data-l10n-id="document_properties_title">Title:</span>
                        <p id="titleField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_author">Author:</span>
                        <p id="authorField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_subject">Subject:</span>
                        <p id="subjectField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_keywords">Keywords:</span>
                        <p id="keywordsField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_creation_date">Creation Date:</span>
                        <p id="creationDateField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_modification_date">Modification Date:</span>
                        <p id="modificationDateField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_creator">Creator:</span>
                        <p id="creatorField">-</p>
                    </div>
                    <div class="separator"></div>
                    <div class="row">
                        <span data-l10n-id="document_properties_producer">PDF Producer:</span>
                        <p id="producerField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_version">PDF Version:</span>
                        <p id="versionField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_page_count">Page Count:</span>
                        <p id="pageCountField">-</p>
                    </div>
                    <div class="row">
                        <span data-l10n-id="document_properties_page_size">Page Size:</span>
                        <p id="pageSizeField">-</p>
                    </div>
                    <div class="separator"></div>
                    <div class="row">
                        <span data-l10n-id="document_properties_linearized">Fast Web View:</span>
                        <p id="linearizedField">-</p>
                    </div>
                    <div class="buttonRow">
                        <button id="documentPropertiesClose" class="overlayButton"><span data-l10n-id="document_properties_close">Close</span></button>
                    </div>
                </div>
            </div>
            <div id="printServiceOverlay" class="container hidden">
                <div class="dialog">
                    <div class="row">
                        <span data-l10n-id="print_progress_message">Preparing document for printing…</span>
                    </div>
                    <div class="row">
                        <progress value="0" max="100"></progress>
                        <span data-l10n-id="print_progress_percent" data-l10n-args='{ "progress": 0 }' class="relative-progress">0%</span>
                    </div>
                    <div class="buttonRow">
                        <button id="printCancel" class="overlayButton"><span data-l10n-id="print_progress_close">Cancel</span></button>
                    </div>
                </div>
            </div>
        </div>
        <!-- overlayContainer -->

    </div>
    <!-- outerContainer 
    <div id="printContainer"></div>
    <div class="editContainer">
    </div>
    -->

    <div class="edit" id="editPoint">

        <div class="editContent">
            <div class="editClose"></div>
            <div>
                <label for="pointX1">id</label>
                <input type="text" id="id">
            </div>
            <div>
                <label for="printType">printType</label>
                <input type="text" id="printType">
            </div>
            <div>
                <label for="defines">defines</label>
                <input type="text" id="defines">
            </div>
            <div>
                <label for="pointX1">X1</label>
                <input type="text" id="pointX1">
            </div>
            <div>
                <label for="pointY1">Y1</label>
                <input type="text" id="pointY1">
            </div>
            <div>
                <label for="pointX2">X2</label>
                <input type="text" id="pointX2">
            </div>
            <div>
                <label for="pointY2">Y2</label>
                <input type="text" id="pointY2">
            </div>
            <div>
                <label for="type">Type</label>
                <select name="type" id="type">
                    <option value="text">text</option>
                    <option value="checkbox">checkbox</option>
                    <option value="radio">radio</option>
                </select>
            </div>
            <div>
                <label for="desc">Desc</label>
                <input type="text" id="desc">
            </div>
            <div>
                <button id="del">刪除</button>
                <button id="reset">重新定位</button>
            </div>
        </div>
    </div>
    <div class="edit" id="dataPoint">

        <div class="editContent">
            <div class="editClose"></div>
            <div class="input-group">
                <span class="input-group-text">定位點資料</span>
                <textarea class="form-control" id="dataPointsJson" rows="30" cols="50"></textarea>
            </div>
            <div>
                <button id="downloadPoint">下載文字檔</button>
                <button id="resetPoint">更新定位點</button>
            </div>
        </div>

    </div>

    <script>
        //PDF檔案
        var pdfFile = 'formTest.pdf';

        //目前滑鼠的位置
        var currentMousePoint = [0, 0, 0, 0]

        //畫面的位置
        var scrollPoint = [0, 0, 0, 0]

        // 定位資料
        var dataPoint = []

        //目前編輯的資料
        var currentData = {}

        // 改變框的位置與大小
        var currentPoint = {
            moving: {
                target: null
            },
            resizing: {
                target: null
            }
        }

        //測試定位資料
        var excelToJson = [{
            "id": "P001",
            "printtype": "20201010",
            "x1": 407,
            "y1": 818,
            "x2": 512,
            "y2": 815,
            "defines": "step03.orderserial.string",
            "desc": "編號"
        }]

        window.onload = function() {
            setTimeout(() => {
                openPDF(pdfFile)
                document.querySelector('#overprint').addEventListener('click', function(e) {
                    overprintPdf(pdfFile, dataPoint)
                })
                document.querySelector('#showPoint').addEventListener('click', function(e) {
                    //showDataPointsJson()
                    document.querySelector('#dataPoint').style.display = "block"
                    var dataPointsJson = document.querySelector('#dataPointsJson')
                    if (!dataPoint) {
                        dataPoint = [{
                            "id": "001",
                            "printtype": "20201010",
                            "x1": 407,
                            "y1": 818,
                            "x2": 512,
                            "y2": 815,
                            "defines": "step03.orderserial.string",
                            "desc": "編號"
                        }]
                    }
                    dataPointsJson.value = JSON.stringify(dataPoint)
                })
                setTimeout(() => {

                    // 取得套印定位資料
                    dataPoint = excelToJson

                    // 將套印定位顯示於畫面預覽
                    drawToScreenRect(dataPoint)

                    // 啟動滑鼠定位編輯功能
                    mouseCoordinate()

                }, 2000)

            }, 1000);

        }

        var drawToScreenRect = function(dataPoint) {
            // excelToJson["sheet1"].filter(x => x.printtype == "TFM200401").forEach(point => {
            //     draw("", [point.x, point.y, 799, 799])
            // });
            if (dataPoint) {
                dataPoint.forEach(x => {
                    x.x1 = x.x1 || parseInt(x.x) || 0
                    x.y1 = x.y1 || parseInt(x.y) || 0
                    x.x2 = x.x2 || parseInt(x.x1) + 30 || 0
                    x.y2 = x.y2 || parseInt(x.y1) + 4 || 0
                    draw(x.id, [x.x1, x.y1, x.x2, x.y2])
                })
            }

        }

        var draw = function(id, point) {
            console.log(point)
            var data = dataPoint.find(x => x.id === id)
            var pdfRect = point;
            var pageNumber = 1;
            var pageView = PDFViewerApplication.pdfViewer.getPageView(pageNumber - 1);
            var screenRect = pageView.viewport.convertToViewportRectangle(pdfRect); //pdf的位置轉畫面的位置

            var x = Math.min(screenRect[0], screenRect[2])
            var width = Math.abs(screenRect[0] - screenRect[2])
            var y = Math.min(screenRect[1], screenRect[3])
            var height = Math.abs(screenRect[1] - screenRect[3])
                //console.log("pdf  x=>" + x, "y=>" + y)
                //console.log('web: x=>' + screenRect[0], screenRect[2] + ', y=>' + screenRect[1], screenRect[3])
                // note: needs to be done in the 'pagerendered' event

            //黃色框
            var overlayDiv = document.createElement('div');
            overlayDiv.classList.add("pointDiv")
            overlayDiv.id = id
            overlayDiv.setAttribute('style', 'background-color: rgba(255,255,0,0.5);' +
                'left:' + x + 'px;top:' + y + 'px;width:' + width + 'px;height:' + height + 'px;');
            pageView.div.appendChild(overlayDiv);
            if (data) {
                overlayDiv.innerText = data.desc || ""
            }

            var pointDot = document.createElement('div')
            pointDot.classList.add('pointDot')
            overlayDiv.appendChild(pointDot)

            //純文字
            // var overlayDiv = document.createElement('span');
            // overlayDiv.innerText = point.desc
            // overlayDiv.id = point.defines
            // overlayDiv.classList.add('editText')
            // overlayDiv.setAttribute('style',
            //     'background-color: rgba(255,255,0,0.5);position:absolute;' +
            //     'font-size:' + 1 * 0.8 + 'em;' +
            //     'left:' + Math.min(screenRect[0], screenRect[2]) + 'px;' +
            //     'top:' + (Math.max(screenRect[1], screenRect[3]) - 10) + 'px;');
            // pageView.div.appendChild(overlayDiv);

            // scroll
            // overlayDiv.scrollIntoView(pageView.div, {
            //     top: y
            // });
        }

        //var addText = function() {

        var excelDrawPdf = function() {
            overprintPdf(pdfFile, dataPoint)
        }



        async function overprintPdf(file, points) {
            const {
                degrees,
                PDFDocument,
                rgb,
                StandardFonts,
                PDFFont
            } = PDFLib
            // Fetch an existing PDF document
            const url = file
            const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer())

            // Load a PDFDocument from the existing PDF bytes
            const pdfDoc = await PDFDocument.load(existingPdfBytes)
            pdfDoc.registerFontkit(fontkit)

            //字型
            const font_url = '/web/font/kaiu.ttf'
            const fontBytes = await fetch(font_url).then(res => res.arrayBuffer())
            const customFont = await pdfDoc.embedFont(fontBytes)

            // Get the first page of the document
            const pages = pdfDoc.getPages()
            const firstPage = pages[0]

            // Get the width and height of the first page
            const {
                width,
                height
            } = firstPage.getSize()

            points.forEach(point => {

                //var x = 90
                //var y = 752

                //var x = parseInt(point.x)
                //var y = parseInt(point.y)

                var x = Math.min(point.x1, point.x2)
                var y = Math.min(point.y1, point.y2)

                firstPage.drawText(point.desc, {
                    x: x,
                    y: y,
                    size: 8,
                    font: customFont,
                    color: rgb(0.95, 0.1, 0.1),
                })
            });

            // Serialize the PDFDocument to bytes (a Uint8Array)
            const pdfBytes = await pdfDoc.save()

            // Trigger the browser to download the PDF document
            var d = new Date()
            d.toISOString().replace(/[-,T,:]/g, "").split('.')[0]
            var newFileName = file.split('.')[0] + d.toISOString().replace(/[-,T,:]/g, "").split('.')[0] + file.split('.')[1]
            download(pdfBytes, newFileName, "application/pdf");

        }

        var mouseCoordinate = function() {
            var pageNumber = 1;
            var pageView = PDFViewerApplication.pdfViewer.getPageView(pageNumber - 1);
            var pdfContent = document.querySelector('#viewerContainer')
                //var pdfContent = document.querySelector('.page')
                //var pdfContent = pageView.div

            //垂直線
            var ox = document.createElement('div');
            var oy = document.createElement('div');
            ox.style.width = '100%';
            ox.style.height = '1px';
            ox.style.backgroundColor = '#00f';
            ox.style.position = 'fixed';
            ox.style.left = 0;
            pdfContent.appendChild(ox);

            //水平線
            oy.style.height = '100%';
            oy.style.width = '1px';
            oy.style.backgroundColor = '#00f';
            oy.style.position = 'fixed';
            oy.style.top = 0;
            pdfContent.appendChild(oy);

            //座標游標
            var mouseCursor = document.createElement('div')
            mouseCursor.id = 'mouseCursor'
            pdfContent.appendChild(mouseCursor)

            //
            var tempDiv = document.createElement('div')
            tempDiv.classList.add('tempDiv')
                //pdfContent.appendChild(mouseCursor)

            //PdfViewer
            var pageNumber = 1;
            var pageView = PDFViewerApplication.pdfViewer.getPageView(pageNumber - 1);

            //pdfContent.onmousedown = function(e) {
            pdfContent.addEventListener('mousedown', function(e) {
                //console.log('mouseCoordinate onmousedown', e)
                //滑鼠左鍵＋不加Ctrl
                if (typeof e === 'object' && e.button === 0 && !e.ctrlKey) {
                    scrollPoint = [0, 0, 0, 0]
                    scrollPoint[0] = e.pageX
                    scrollPoint[1] = e.pageY
                    pdfContent.appendChild(tempDiv)
                    tempDiv.id = 'p' + Math.random().toString(36).substring(2)
                    tempDiv.style.left = scrollPoint[0] + 'px'
                    tempDiv.style.top = scrollPoint[1] + 'px'
                    tempDiv.style.width = '0px'
                    tempDiv.style.height = '0px'

                    currentMousePoint = []
                    currentMousePoint[0] = {
                        layerX: e.layerX,
                        layerY: e.layerY,
                        offsetX: e.offsetX,
                        offsetY: e.offsetY,
                        pageX: e.pageX,
                        pageY: e.pageY,
                        screenX: e.screenX,
                        screenY: e.screenY
                    }
                }
            })

            //pdfContent.onmouseup = function(e) {
            pdfContent.addEventListener('mouseup', function(e) {
                //滑鼠左鍵＋不加Ctrl
                if (typeof e === 'object' && e.button === 0 && !e.ctrlKey) {
                    scrollPoint[2] = e.layerX
                    scrollPoint[3] = e.layerY
                    pdfContent.removeChild(tempDiv)

                    currentMousePoint[1] = {
                        layerX: e.layerX,
                        layerY: e.layerY,
                        offsetX: e.offsetX,
                        offsetY: e.offsetY,
                        pageX: e.pageX,
                        pageY: e.pageY,
                        screenX: e.screenX,
                        screenY: e.screenY
                    }

                    var point = []
                    point[0] = currentMousePoint[0].layerX
                    point[1] = currentMousePoint[0].layerY
                    point[2] = currentMousePoint[1].layerX
                    var diffScreenY = currentMousePoint[0].screenY - currentMousePoint[1].screenY
                    point[3] = currentMousePoint[0].layerY - diffScreenY

                    var point1 = pageView.viewport.convertToPdfPoint(point[0], point[1])
                    var point2 = pageView.viewport.convertToPdfPoint(point[2], point[3])


                    if (currentData.id) {
                        //update

                        var data = dataPoint.find(x => x.id == currentData.id)
                        data.x1 = point1[0]
                        data.y1 = point1[1]
                        data.x2 = point2[0]
                        data.y2 = point2[1]

                        document.querySelector('#' + data.id).remove()
                        draw(currentData.id, [point1[0], point1[1], point2[0], point2[1]])
                        currentData = {}
                    } else {
                        //save
                        dataPoint.push({
                            id: tempDiv.id,
                            x1: point1[0],
                            y1: point1[1],
                            x2: point2[0],
                            y2: point2[1],
                        })
                        if (point1[0] != point2[0] && point1[1] != point2[1]) {
                            draw(tempDiv.id, [point1[0], point1[1], point2[0], point2[1]])
                        }

                    }

                }
            })

            //pdfContent.onmousemove = function(e) {
            pdfContent.addEventListener('mousemove', function(e) {
                var e = e || event;

                e.preventDefault()
                    //e.stopPropagation()
                    //console.log('mousemove', e)


                var x = e.pageX;
                var y = e.pageY;
                var p = pageView.viewport.convertToPdfPoint(e.layerX, e.layerY)
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                var scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft;

                ox.style.top = y - scrollTop - 2 + 'px';
                oy.style.left = x - scrollLeft - 2 + 'px';
                //ox.innerText = "PDF  X:" + (Math.round(p[0] * 100) / 100) + 'px；' + "Y:" + (Math.round(p[1] * 100) / 100) + 'px；';
                ox.style.color = '#00f'

                //document.querySelector('.loadingInProgress').innerHTML = 'x : ' + x + '<br/>y : ' + y;    
                //var oDiv = document.getElementById('');

                //滑鼠指標
                mouseCursor.style.left = e.pageX - scrollLeft + 10 + 'px';
                mouseCursor.style.top = e.pageY - scrollTop + 10 + 'px';
                mouseCursor.innerText = "X:" + (Math.round(p[0] * 100) / 100) + 'px；' + "Y:" + (Math.round(p[1] * 100) / 100) + 'px；';
                //mouseCursor.innerText = "X:" + e.layerX + 'px；' + "Y:" + e.layerY + 'px；';

                //框線
                tempDiv.style.left = Math.min(e.pageX, scrollPoint[0]) - scrollLeft - 5 + 'px'
                tempDiv.style.top = Math.min(e.pageY, scrollPoint[1]) - scrollTop - 5 + 'px'
                tempDiv.style.width = Math.abs(e.pageX - scrollPoint[0]) + 'px'
                tempDiv.style.height = Math.abs(e.pageY - scrollPoint[1]) + 'px'

            });

            // oncontextmenu="event.preventDefault();"
            document.body.oncontextmenu = function(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            pdfContent.addEventListener('mousedown', function(e) {
                //console.log('mousedown test', e)
                if (typeof e === 'object' && e.button === 2) {
                    if (Array.from(e.target.classList).some(x => x == "pointDiv")) {
                        document.querySelector('.edit').style.display = "block"
                            //console.log('mousedown button==2', e)
                        var data = dataPoint.find(x => x.id == e.target.id)
                        if (data) {
                            document.querySelector('.edit .editContent input#id').value = data.id || 'h' + Math.random().toString(36).substring(2)
                            document.querySelector('.edit .editContent input#pointX1').value = data.x1
                            document.querySelector('.edit .editContent input#pointY1').value = data.y1
                            document.querySelector('.edit .editContent input#pointX2').value = data.x2
                            document.querySelector('.edit .editContent input#pointY2').value = data.y2
                            document.querySelector('.edit .editContent input#desc').value = data.desc || ""
                                //document.querySelector('.edit .editContent input#printtype').value = data.printtype || ""
                            document.querySelector('.edit .editContent input#defines').value = data.defines || ""
                            document.querySelector('.edit .editContent select#type').value = data.type || "text"
                        }

                    }
                }
            })

            document.querySelector('#editPoint .editClose').addEventListener('click', function(e) {
                document.querySelector('#editPoint').style.display = "none"
                var data = dataPoint.find(x => x.id == document.querySelector('.edit .editContent input#id').value)
                if (data) {
                    data.id = document.querySelector('.edit .editContent input#id').value
                    data.x1 = parseFloat(document.querySelector('.edit .editContent input#pointX1').value) || 0
                    data.y1 = parseFloat(document.querySelector('.edit .editContent input#pointY1').value) || 0
                    data.x2 = parseFloat(document.querySelector('.edit .editContent input#pointX2').value) || 0
                    data.y2 = parseFloat(document.querySelector('.edit .editContent input#pointY2').value) || 0
                    data.desc = document.querySelector('.edit .editContent input#desc').value || ""
                        //data.printtype = document.querySelector('.edit .editContent input#printtype').value || ""
                    data.defines = document.querySelector('.edit .editContent input#defines').value || ""
                    data.type = document.querySelector('.edit .editContent select#type').value || ""


                    //console.log('edit dom', data.id)
                    refreshScreen(data)
                        // var currentDom = document.querySelector('#' + data.id)
                        // var screenRect = pageView.viewport.convertToViewportRectangle([data.x1, data.y1, data.x2, data.y2])
                        // var x = Math.min(screenRect[0], screenRect[2])
                        // var width = Math.abs(screenRect[0] - screenRect[2])
                        // var y = Math.min(screenRect[1], screenRect[3])
                        // var height = Math.abs(screenRect[1] - screenRect[3])
                        // currentDom.style.left = x + 'px'
                        // currentDom.style.top = y + 'px'
                        // currentDom.style.height = height + 'px'
                        // currentDom.style.width = width + 'px'
                        // currentDom.innerText = data.desc
                }
            })

            document.querySelector('#reset').addEventListener('click', function(e) {
                document.querySelector('.edit').style.display = "none"
                var data = dataPoint.find(x => x.id == document.querySelector('.edit .editContent input#id').value)
                if (data) {
                    document.querySelector('#' + data.id).style.backgroundColor = "#e0f"
                    currentData = data
                }
            })

            document.querySelector("#del").addEventListener('click', function(e) {
                document.querySelector('.edit').style.display = "none"
                var id = document.querySelector('.edit .editContent input#id').value
                if (id) {
                    var index = dataPoint.map(x => x.id).indexOf(id)
                    dataPoint.splice(index, 1)
                    document.querySelector('#' + id).remove()
                }
            })

            document.addEventListener('keyup', function(e) {
                //console.log(e.keyCode)
                if (e.keyCode == 27) {
                    if (currentData.id) {
                        document.querySelector('#' + currentData.id).style.backgroundColor = 'rgba(255, 255, 0, 0.5)'
                        currentData = {}
                    }
                }
            })

            var updateDataPoints = function() {
                var dataPointsJson = document.querySelector('#dataPointsJson')
                if (dataPointsJson.value) {
                    dataPoint = JSON.parse(dataPointsJson.value)
                    dataPoint.forEach(x => {
                        refreshScreen(x)
                    })

                    //console.log(dataPoint)
                }
            }

            var refreshScreen = function(data) {
                var currentDom = document.querySelector('#' + data.id)
                if (currentDom) {
                    //update
                    document.querySelector('#' + data.id).remove()
                    draw(data.id, [data.x1, data.y1, data.x2, data.y2])
                } else {
                    draw(data.id, [data.x1, data.y1, data.x2, data.y2])
                }
            }

            var divToPdfPoints = function(div) {
                var data = dataPoint.find(x => x.id == div.id)
                var left = parseInt(div.style.left.replace('px'))
                var top = parseInt(div.style.top.replace('px'))
                var width = parseInt(div.style.width.replace('px'))
                var height = parseInt(div.style.height.replace('px'))

                var pdfPoint1 = pageView.viewport.convertToPdfPoint(left, top)
                var x1 = pdfPoint1[0]
                var y1 = pdfPoint1[1]

                var pdfPoint2 = pageView.viewport.convertToPdfPoint(left + width, top + height)
                var x2 = pdfPoint2[0]
                var y2 = pdfPoint2[1]

                return [x1, y1, x2, y2]
            }

            document.querySelector('#dataPoint .editClose').addEventListener('click', function(e) {
                document.querySelector('#dataPoint').style.display = "none"
                updateDataPoints()
            })

            document.querySelector('#dataPoint #resetPoint').addEventListener('click', function() {
                updateDataPoints()
            })

            document.querySelector('#dataPoint #downloadPoint').addEventListener('click', function() {
                window.setTimeout(function() {
                    //var dataPointsJson = document.querySelector('#dataPointsJson')
                    //dataPointsJson.value = JSON.stringify(dataPoint)
                    download(JSON.stringify(dataPoint), "dataPointJson" + getDateNowString() + ".txt", "text/plain");
                }, 2000)
            })

            //改變框大小
            pdfContent.addEventListener('mouseover', function(e) {
                //console.log('pointDiv 123', e)
                if (e.target.classList && Array.from(e.target.classList).filter(x => x == 'pointDiv').length > 0) {
                    currentPoint.moving.target = e.target
                }

                if (e.target.classList && Array.from(e.target.classList).filter(x => x == 'pointDot').length > 0) {
                    currentPoint.resizing.target = e.target
                }
            })

            pdfContent.addEventListener('mousedown', function(e) {
                if (e.target != currentPoint.moving.target) return
                e.stopPropagation()

                //滑鼠左鍵＋Ctrl
                if (typeof e === 'object' && e.button === 0 && e.ctrlKey) {
                    currentPoint.moving.x = e.pageX
                    currentPoint.moving.y = e.pageY
                    currentPoint.moving.left = parseFloat(e.target.style.left.replace("px", "")) || 0
                    currentPoint.moving.top = parseFloat(e.target.style.top.replace("px", "")) || 0
                    currentPoint.moving.dropType = true
                    console.log('moveeing mousedown', e.target, currentPoint, e)
                }

            })

            pdfContent.addEventListener('mousemove', function(e) {
                e.stopPropagation()

                //滑鼠左鍵＋Ctrl
                if (typeof e === 'object' && e.button === 0) {
                    if (currentPoint.moving.dropType) {
                        console.log('moveeing mousemove', currentPoint.moving.target, currentPoint, e)
                        currentPoint.moving.target.style.left = currentPoint.moving.left - (currentPoint.moving.x - e.pageX) + "px"
                        currentPoint.moving.target.style.top = currentPoint.moving.top - (currentPoint.moving.y - e.pageY) + "px"
                    }
                }

            })

            pdfContent.addEventListener('mouseup', function(e) {
                e.stopPropagation()

                //滑鼠左鍵＋Ctrl
                if (currentPoint.moving.dropType && typeof e === 'object' && e.button === 0) {

                    var pdfPoints = divToPdfPoints(currentPoint.moving.target)
                    var data = dataPoint.find(x => x.id == currentPoint.moving.target.id)
                    data.x1 = pdfPoints[0]
                    data.y1 = pdfPoints[1]
                    data.x2 = pdfPoints[2]
                    data.y2 = pdfPoints[3]

                    //狀態初始化
                    currentPoint.moving.dropType = false
                }

            })

            //resizing
            pdfContent.addEventListener('mousedown', function(e) {
                if (e.target != currentPoint.resizing.target) return
                e.stopPropagation()

                //滑鼠左鍵＋Ctrl
                if (typeof e === 'object' && e.button === 0 && e.ctrlKey) {
                    currentPoint.resizing.parent = currentPoint.resizing.target.parentNode
                    currentPoint.resizing.x = e.pageX
                    currentPoint.resizing.y = e.pageY
                    currentPoint.resizing.left = parseFloat(currentPoint.resizing.parent.style.left.replace("px", "")) || 0
                    currentPoint.resizing.top = parseFloat(currentPoint.resizing.parent.style.top.replace("px", "")) || 0
                    currentPoint.resizing.width = parseFloat(currentPoint.resizing.parent.style.width.replace("px", "")) || 0
                    currentPoint.resizing.height = parseFloat(currentPoint.resizing.parent.style.height.replace("px", "")) || 0
                    currentPoint.resizing.dropType = true
                }

            })

            pdfContent.addEventListener('mousemove', function(e) {
                e.stopPropagation()

                //滑鼠左鍵＋Ctrl
                if (typeof e === 'object' && e.button === 0) {
                    if (currentPoint.resizing.dropType) {
                        currentPoint.resizing.parent.style.width = currentPoint.resizing.width - (currentPoint.resizing.x - e.pageX) + "px"
                        currentPoint.resizing.parent.style.height = currentPoint.resizing.height - (currentPoint.resizing.y - e.pageY) + "px"
                    }
                }
            })

            pdfContent.addEventListener('mouseup', function(e) {
                e.stopPropagation()

                //滑鼠左鍵＋Ctrl
                if (currentPoint.resizing.dropType && typeof e === 'object' && e.button === 0) {

                    //更新節點資料
                    var pdfPoints = divToPdfPoints(currentPoint.resizing.parent)
                    var data = dataPoint.find(x => x.id == currentPoint.resizing.parent.id)
                    data.x1 = pdfPoints[0]
                    data.y1 = pdfPoints[1]
                    data.x2 = pdfPoints[2]
                    data.y2 = pdfPoints[3]

                    //狀態初始化
                    currentPoint.resizing.dropType = false
                    currentPoint.resizing.target = null
                    currentPoint.resizing.parent = null
                }
            })

        }

        //開啟PDF
        var openPDF = function(pdfFile) {
            var file = pdfFile
            if (file && file.lastIndexOf("file:", 0) === 0) {
                // file:-scheme. Load the contents in the main thread because QtWebKit
                // cannot load file:-URLs in a Web Worker. file:-URLs are usually loaded
                // very quickly, so there is no need to set up progress event listeners.
                //PDFViewerApplication.setTitleUsingUrl(file);
                const xhr = new XMLHttpRequest();
                xhr.onload = function() {
                    PDFViewerApplication.open(new Uint8Array(xhr.response));
                };
                xhr.open("GET", file);
                xhr.responseType = "arraybuffer";
                xhr.send();
                return;
            }

            if (file) {
                PDFViewerApplication.open(file);
            }


        }


        var getDateNowString = function() {
            var d = new Date()
            return d.toISOString().replace(/[-,T,:]/g, "").split('.')[0]
        }
    </script>
</body>

</html>